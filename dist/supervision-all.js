!function(e){function t(r){if(s[r])return s[r].exports;var o=s[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var s={};return t.m=e,t.c=s,t.p="",t(0)}([function(e,t,s){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}for(var o=s(2),a=r(o),i=s(1),n=s(3),c=new Vue({el:"#filterSection",data:{filterOptions:{areaCode:[],sourceCode:[],deptsCode:[]},dateFilter:[{title:"全部",status:!0},{title:"上周",status:!0},{title:"本周",status:!0},{title:"下周",status:!0},{title:"时段",status:!0}],dateOptions:{show:!1,type:"date",value:"2016-6-21",begin:"2016-6-20",end:"2016-12-25",x:0,y:0,range:!0},area:{show:[{status:"1",name:"全部"}],more:[]},source:{show:[],more:[]},derivedMeeting:[],org:{show:[],more:[]},depts:{show:[],more:[]},stateList:[]},methods:{changeTime:function(e){e.stopPropagation();var t=e.currentTarget,s=$(t),r=t.getAttribute("data-mark");if(!s.hasClass("btn-success")||"custom"==r){switch($("#datePicker").find(".btn").removeClass("btn-success"),s.addClass("btn-success"),r){case"all":delete this.filterOptions.searchBeginDate,delete this.filterOptions.searchEndDate;break;case"lastweek":this.filterOptions.searchBeginDate=moment().day(-6).format("YYYY-MM-DD"),this.filterOptions.searchEndDate=moment().day(0).format("YYYY-MM-DD");break;case"thisweek":this.filterOptions.searchBeginDate=moment().weekday(1).format("YYYY-MM-DD"),this.filterOptions.searchEndDate=moment().day(7).format("YYYY-MM-DD");break;case"nextweek":this.filterOptions.searchBeginDate=moment().day(8).format("YYYY-MM-DD"),this.filterOptions.searchEndDate=moment().day(14).format("YYYY-MM-DD");break;case"custom":var o=$("#startDate").val().split("/"),a=$("#endDate").val().split("/");this.filterOptions.searchBeginDate=o[2]+"-"+o[0]+"-"+o[1],this.filterOptions.searchEndDate=a[2]+"-"+a[0]+"-"+a[1]}p.fetchTransactions(i.supervisionRequest.searchUrl)}},changeArea:function(e,t,s){if("source"==s&&("MEETING"==this.source[t][e].diccode||0==e&&"show"==t))for(var r=this.filterOptions.sourceCode,o=this.derivedMeeting,a=0;a<o.length;a++){var n=$.inArray(o[a].diccode,r);n>-1&&(r.splice(n,1),this.derivedMeeting[a].status="0")}var c=this[s].show[0],u=this[s].show;if("more"==t&&(u=this[s].more),0==e&&"show"==t){if("1"==c.status)return;c.status="1";for(var l=1,d=u.length;d>l;l++)u[l].status="0";this.filterOptions[s+"Code"]=[];for(var h=this[s].more,f=0,g=h.length;g>f;f++)h[f].status="0";this[s].more=h}else{c.status="0";var v=this.filterOptions[s+"Code"],m="diccode";if("depts"==s&&(m="ou"),"1"==u[e].status){u[e].status="0";for(var y in v)v[y]==u[e][m]&&v.splice(y,1)}else u[e].status="1",v.push(u[e][m]);this.filterOptions[s+"Code"]=v}if("more"==t){var k=this[s].show;this[s]={show:k,more:u}}else{var w=this[s].more;this[s]={show:u,more:w}}p.fetchTransactions(i.supervisionRequest.searchUrl)},changeMeeting:function(e){for(var t=this.source.show,s=this.filterOptions.sourceCode,r=0;r<t.length;r++)if((0==r||"会议"==t[r].dicname)&&"1"==t[r].status){t[r].status="0";var o=$.inArray(t[r].diccode,s);s.splice(o,1)}var a=this.derivedMeeting[e],n=$.inArray(a.diccode,s);n>-1?(s.splice(n,1),a.status="0"):(a.status="1",s.push(a.diccode)),p.fetchTransactions(i.supervisionRequest.searchUrl)},changeOrg:function(e,t){var s=this.org.show,r=this.org.more;if("more"==t&&(s=this.org.more,r=this.org.show),"1"!=s[e].status){for(var o=0,a=s.length;a>o;o++)s[o].status="0";for(var i=0,c=r.length;c>i;i++)r[i].status="0";s[e].status="1","more"==t?this.org={show:r,more:s}:this.org={show:s,more:r},(0,n.loadingCover)(),this.fetchDepts(s[e].ou)}},fetchDepts:function(e){var t=this;$.ajax({type:"get",dataType:"json",url:i.supervisionRequest.deptListUrl+e,success:function(e,s,r){var o=[];for(var a in e)2==e[a].level&&(e[a].status="0",o.push(e[a]));var i=[{status:"1",name:"全部"}];t.depts={show:i.concat(o.slice(0,6)),more:o.slice(6)},$.unblockUI()},error:function(e,t,s){$.unblockUI(),console.log(s.key),console.log(e)}})}},created:function(){var e=this,t={supAreaUrl:i.supervisionRequest.supAreaUrl,supSourceUrl:i.supervisionRequest.supSourceUrl,orgUrl:i.supervisionRequest.orgUrl};for(var s in t)$.ajax({type:"get",dataType:"json",url:t[s],success:function(t,s,r){for(var o in t)t[o].status="0";var a=r.key,i=[{status:"1",dicname:"全部"}];if("orgUrl"==a&&(i=[{status:"1",name:"全部"}]),"supAreaUrl"==a)e.area={show:i.concat(t.slice(0,6)),more:t.slice(6)};else if("supSourceUrl"==a){for(var n=[],u=[],l=0;l<t.length;l++)"10019"==t[l].parentid?n.push(t[l]):u.push(t[l]);e.derivedMeeting=n,e.source={show:i.concat(u.slice(0,6)),more:u.slice(6)}}else"orgUrl"==a?(e.org={show:t.slice(0,6),more:t.slice(6)},c.changeOrg(0,"show")):e.depts={show:i.concat(t.slice(0,6)),more:t.slice(6)}},error:function(e,t,s){console.log(s.key),console.log(e)}}).key=s},ready:function(){$("#startDate").daterangepicker({singleDatePicker:!0,showDropdowns:!0},function(e,t,s){}),$("#endDate").daterangepicker({singleDatePicker:!0,showDropdowns:!0}),$("#filterSection").on("click","a.drop-menu-btn",function(e){e.stopPropagation()})}}),u=new Array(8),l=0;8>l;l++)u[l]="sorting";var p=new Vue({el:"#result-section",data:{ths:[{key:"code",val:"督办编号"},{key:"name",val:"督办事项名称"},{key:"accountablename",val:"责任领导(A)"},{key:"responsiblename",val:"责任人(R)"},{key:"estimatedcompletetiontime",val:"计划完成时间"},{key:"urgency",val:"紧急程度"},{key:"importance",val:"重要程度"},{key:"rate",val:"最新进展"}],keyItems:{sorting:u,total:[],show:[],current:1},pageSize:3,levelBackground:["gray","#A1C636","#5CB85C","#F0AD4E","#D9534F"]},created:function(){i.supervisionRequest.searchUrl+="?page=0&size=1000",this.fetchTransactions(i.supervisionRequest.searchUrl)},methods:{changePage:function(e,t,s,r){var o=this[r+"Items"];o.current=e,this.changeHandler(e,r,o)},sortColumn:function(e,t){function s(e,t){return/^\d/.test(e)^/^\D/.test(t)?e>t?1:e==t?0:-1:e>t?-1:e==t?0:1}var r=this,o=this[t+"Items"],a=o.sorting[e];"sorting_asc"==a?!function(){var a=u.concat();a[e]="sorting_desc",o.sorting=a;var i=r.ths[e].key;o.total.sort(function(e,t){return s(t[i],e[i])}),r.changeHandler(o.current,t,o)}():!function(){var a=u.concat();a[e]="sorting_asc",o.sorting=a;var i=r.ths[e].key;o.total.sort(function(e,t){return s(e[i],t[i])}),r.changeHandler(o.current,t,o)}()},changeHandler:function(e,t,s){var r=this.pageSize;s.show=s.total.slice((e-1)*r,r*e)},fetchTransactions:function(e){var t={};for(var s in c.filterOptions)t[s]=c.filterOptions[s];0==t.areaCode.length?delete t.areaCode:t.areaCode=t.areaCode.join(","),t.scope=t.deptsCode,delete t.deptsCode,0==t.scope.length?delete t.scope:t.scope=t.scope.join(","),t.source=t.sourceCode,delete t.sourceCode,0==t.source.length?delete t.source:t.source=t.source.join(",");var r=this;t=(0,a["default"])(t),$.ajax({type:"POST",dataType:"json",data:t,contentType:"application/json",url:e,success:function(e,t,s){for(var o=[],a=0,i=e.length;i>a;a++){var n=e[a];n.latestTrace?(n.rate=n.latestTrace.rate,n.latestDesc=n.latestTrace.description):(n.rate=0,n.latestDesc=""),n.rate<25?n.rateState="progress-bar-danger":n.rate<75?n.rateState="progress-bar-warning":n.rateState="progress-bar-success",o.push(n)}var c=u.concat(),l=r.pageSize;r.keyItems={total:o,show:o.slice(0,l),sorting:c,current:1};var p=Number(r.pageSize)||10,d=Number(r.keyItems.total.length);$("#key-pagination").extendPagination({totalCount:d,limit:p,name:"key",callback:function(e,t,s,o){r.changePage(e,t,s,o)}})},error:function(e,t,s){console.log(e)}})},newfunc:function(){}}})},function(e,t){"use strict";var s="http://172.16.51.137",r="?apikey=e71982d5401b488da4acef8827c41845",o=s+":8010/api/cache/find/type/source-code",a=s+":8010/api/contact/getOrglist?apikey=e71982d5401b488da4acef8827c41845",i=s+":8010/api/cache/find/type/area-code",n=s+":8010/api/contact/getorgbyou?apikey=e71982d5401b488da4acef8827c41845&ou=",c=s+":8000/api/v1.0/supervision/search",u=s+":8010/api/supervision/findchildren/",l=s+":8010/api/supervision/add",p=s+":8010/api/contact/getchlistbyou?apikey=e71982d5401b488da4acef8827c41845&ou=",d=s+":8010/api/contact/searchuser?apikey=e71982d5401b488da4acef8827c41845",h=s+":8010/api/supervision/postpone/",f=s+":8010/api/supervision/trace/",g=s+":8010/api/supervision/close/",v=s+":8010/api/supervision/delete/",m={supervisionRequest:{apikey:r,supSourceUrl:o,orgUrl:a,supAreaUrl:i,deptUrl:n,searchUrl:c,supDetailUrl:u,supAddUrl:l,searchuserUrl:d,deptListUrl:p,postphoneUrl:h,traceUrl:f,closeUrl:g,revokeUrl:v}};e.exports=m},function(e,t,s){e.exports={"default":s(4),__esModule:!0}},function(e,t,s){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,s,r,o,a){if(s){var i=new Date;i.setTime(i.getTime()+24*s*60*60*1e3);var n=i.toGMTString()}else var n="";var c=e+"="+escape(t);n&&(c+=";expires="+n),r&&(c+=";path="+escape(r)),o&&(c+=";domain="+escape(o)),a&&(c+=";secure="+a),document.cookie=c}function a(e){var t,s=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(s))?unescape(t[2]):null}function i(e){creatCookie(e,"",-1)}function n(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),s=window.location.search.substr(1).match(t);return null!=s?unescape(s[2]):null}function c(){$.blockUI({message:"数据获取中，请稍候... ...",css:{border:"none",padding:"15px",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px",opacity:.5,color:"#fff"}})}function u(e,t){var s=function(e,s,r){console.log("result",e),t.list=e,t.successNext&&t.successNext()},r=function(e,t,s){console.log("error",e)},o={type:"get",url:e.URL+e.QueryString,success:s,error:r};"post"==e.METHOD&&(o={type:"post",url:e.URL+e.QueryString,data:e.PLAYLOAD,contentType:e.CONTENT_TYPE,success:s,error:r}),$.ajax(o)}Object.defineProperty(t,"__esModule",{value:!0}),t.fetchAjaxService=t.loadingCover=t.getQueryString=t.deleteCookie=t.getCookie=t.setCookie=t.add_supervision=t.fetch_sourceFromServer=t.fetch_areaFromServer=t.fetch_deptsFromServer=t.fetch_serviceByHttpProtocol=void 0;var l=s(2),p=r(l),d=s(1),h=function(e,t,s,r,o){"post"==t&&(s=(0,p["default"])(s)),$.ajax({url:e,type:t,data:s,contentType:"application/json",success:function(e,t,s){console.log("success"),r(e,t,s)},error:function(e,t,s){console.log("error"),o(e,t,s)}})},f=function(e,t){var s=d.supervisionRequest.deptUrl+e;h(s,"get",{},t,function(e,t,s){console.log(e)})},g=function(e){var t=d.supervisionRequest.supSourceUrl;h(t,"get",{},e,function(e,t,s){console.log(e)})},v=function(e){var t=d.supervisionRequest.supAreaUrl;h(t,"get",{},e,function(e,t,s){console.log(e)})},m=function(e,t){var s=d.supervisionRequest.supAddUrl;h(s,"post",e,t,function(e,t,s){console.log(e)})};t.fetch_serviceByHttpProtocol=h,t.fetch_deptsFromServer=f,t.fetch_areaFromServer=v,t.fetch_sourceFromServer=g,t.add_supervision=m,t.setCookie=o,t.getCookie=a,t.deleteCookie=i,t.getQueryString=n,t.loadingCover=c,t.fetchAjaxService=u},function(e,t,s){var r=s(5),o=r.JSON||(r.JSON={stringify:JSON.stringify});e.exports=function(e){return o.stringify.apply(o,arguments)}},function(e,t){var s=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=s)}]);